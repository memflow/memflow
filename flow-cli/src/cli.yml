name: flow-cli
version: "0.1"
author: "ko1N"
about: memflow cli interface

args:
    - connector:
        short: c
        long: connector
        help: selects the connector type (bridge, qemu_procfs)
        takes_value: true
    - connector_args:
        short: a
        long: connector-args
        help: additional arguments supplied to the connector
        takes_value: true
    - url:
        long: url
        value_name: URL
        help: bridge socket url
        takes_value: true
    - config:
        long: config
        help: sets the memflow config toml file
        takes_value: true
    - machine:
        long: machine
        help: when using a config file this will set the machine by its name
        takes_value: true
    - verbose:
        short: v
        multiple: true
        help: sets the level of verbosity

subcommands:
    - kernel:
        about: kernel interface
        subcommands:
            - module:
                about: kernel module (driver) interface
                subcommands:
                    - ls:
                        about: lists loaded kernel modules (drivers)
                    - export:
                        subcommands:
                            - ls:
                                about: lists all exports within the given kernel module
                                args:
                                    - module_name:
                                        help: the name of the kernel module thats being inspected
                                        index: 1
                                        required: true
                    - section:
                        subcommands:
                            - ls:
                                about: lists all sections within the given kernel module
                                args:
                                    - module_name:
                                        help: the name of the kernel module thats being inspected
                                        index: 1
                                        required: true
    - process:
        about: process interface
        subcommands:
            - ls:
                about: lists all running processes
            - module:
                subcommands:
                    - ls:
                        about: lists all modules within the given process
                        args:
                            - process_name:
                                help: the name of the process thats being inspected
                                index: 1
                                required: true
                    - export:
                        subcommands:
                            - ls:
                                about: lists all module exports within the given process and module
                                args:
                                    - process_name:
                                        help: the name of the process thats being inspected
                                        index: 1
                                        required: true
                                    - module_name:
                                        help: the name of the module thats being inspected
                                        index: 2
                                        required: true
    - keylog:
        about: logs all pressed keys
